{% extends 'base.html' %}

{% block content %}


<div class="text-muted mb-3">
  Showing <span id="products-rendered-count">0</span> of 
  <span id="products-total-count">0</span> products
</div>


<button class="btn btn-primary d-lg-none fixed-bottom mb-4 mx-4 rounded-pill shadow-lg" 
        data-bs-toggle="modal" data-bs-target="#mobileFiltersModal" style="z-index: 1029;">
  <i class="ni ni-filter me-2"></i> Filters
</button> 

<div id="product-count-tracker"  data-count="0" data-total="0" style="display: none;"></div>
     
<div class="container-fluid py-4 px-2 px-md-4">
  <div class="row g-4">
  
    <!-- Filter Sidebar -->
    <div class="col-lg-3 order-lg-1 order-2 position-sticky" style="top: 100px; height: fit-content; align-self: start;">
      <div class="card shadow-sm p-3">
        {% include 'shop/components/filters/sidebar2.html' %}
      </div>
    </div>
  
    <!-- Products Grid (scrollable) -->
    <div class="col-lg-9 order-lg-2 order-1">
      {% include 'shop/components/products/empty_state.html' %}

      <div class="scrollable-products-container" style="max-height: calc(100vh - 120px); overflow-y: auto;">
        <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 justify-content-center" id="products-grid">
          {% include 'shop/components/products/loading_state.html' %}
        </div>
        <div id="end-page"></div>
      </div>
    </div>
    
  </div>
</div>



<style>
  /* Desktop behavior */
  @media (min-width: 992px) {
    .scrollable-products-container {
      padding-right: 10px; /* Prevents scrollbar overlap */
    }
    
    /* Custom scrollbar (optional) */
    .scrollable-products-container::-webkit-scrollbar {
      width: 6px;
    }
    .scrollable-products-container::-webkit-scrollbar-track {
      background: #f8f9fa;
    }
    .scrollable-products-container::-webkit-scrollbar-thumb {
      background: #dee2e6;
      border-radius: 3px;
    }
  }

  /* Mobile behavior */
  @media (max-width: 991.98px) {
    .position-lg-sticky {
      position: relative !important;
    }
    .scrollable-products-container {
      max-height: none !important;
      overflow-y: visible !important;
    }
  }
</style>
{% include 'shop/components/modals/quick_view.html' %}
{% endblock %}

{% block extra_js %}
<script src="/static/js/products/productMetaTracker.js"></script>
<script src="/static/js/products/quickViewModal.js"></script>
<script src="/static/js/products/infiniteScroll.js"></script>
<script src="/static/js/products/search.js"></script>
  <!-- Core Modules -->
<script src="/static/js/products/filterManager.js"></script>
<script src="/static/js/products/productRenderer.js"></script>
<script src="/static/js/shop/products.js"></script>
<script src="/static/js/products/main.js"></script>

{% endblock %}